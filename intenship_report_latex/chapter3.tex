\documentclass[main.tex]{subfiles}

\begin{document}

\section{WebSecPen системийн хөгжүүлэлт}

\subsection{Системийн шаардлагын шинжилгээ}

\subsubsection{Use Case диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=WebSecPen системийн Use Case диаграм]
                    WebSecPen Security Scanning System
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│                       Normal User                               │
│                          │                                      │
│                          ├── Register Account                   │
│                          │                                      │
│                          ├── Login/Logout                       │
│                          │                                      │
│                          ├── Start Security Scan               │
│                          │      │                              │
│                          │      ├── URL Scan                   │
│                          │      ├── Scheduled Scan             │
│                          │      └── Quick Scan                 │
│                          │                                      │
│                          ├── View Scan Results                 │
│                          │      │                              │
│                          │      ├── View Vulnerabilities       │
│                          │      ├── View Risk Assessment       │
│                          │      └── View AI Recommendations    │
│                          │                                      │
│                          ├── Generate Reports                  │
│                          │      │                              │
│                          │      ├── PDF Report                 │
│                          │      ├── JSON Export                │
│                          │      └── CSV Export                 │
│                          │                                      │
│                          ├── Manage Profile                    │
│                          │      │                              │
│                          │      ├── Update Settings            │
│                          │      ├── Change Password            │
│                          │      └── Enable MFA                 │
│                          │                                      │
│                          └── View Scan History                 │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│                     Premium User                                │
│                          │                                      │
│                          ├── [All Normal User Functions]       │
│                          │                                      │
│                          ├── Advanced Scanning                 │
│                          │      │                              │
│                          │      ├── Deep Scan                  │
│                          │      ├── Custom Scan Rules          │
│                          │      └── Bulk URL Scanning          │
│                          │                                      │
│                          ├── Team Management                   │
│                          │      │                              │
│                          │      ├── Invite Team Members        │
│                          │      ├── Share Scan Results         │
│                          │      └── Team Dashboard             │
│                          │                                      │
│                          └── Priority Support                  │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│                      Admin User                                 │
│                          │                                      │
│                          ├── [All Premium User Functions]      │
│                          │                                      │
│                          ├── User Management                   │
│                          │      │                              │
│                          │      ├── View All Users             │
│                          │      ├── Manage User Roles          │
│                          │      ├── Ban/Unban Users            │
│                          │      └── View User Activity         │
│                          │                                      │
│                          ├── System Monitoring                 │
│                          │      │                              │
│                          │      ├── View System Stats          │
│                          │      ├── Monitor Scan Queue         │
│                          │      ├── Resource Usage             │
│                          │      └── Error Logs                 │
│                          │                                      │
│                          ├── Configuration                     │
│                          │      │                              │
│                          │      ├── System Settings            │
│                          │      ├── Scan Parameters            │
│                          │      └── Security Policies          │
│                          │                                      │
│                          └── Audit & Compliance                │
│                                 │                              │
│                                 ├── Audit Logs                 │
│                                 ├── Compliance Reports         │
│                                 └── Security Assessments       │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│                    External Systems                             │
│                          │                                      │
│                          ├── OWASP ZAP Scanner                 │
│                          │      │                              │
│                          │      ├── Execute Security Scans     │
│                          │      ├── Return Vulnerability Data  │
│                          │      └── Provide Scan Reports       │
│                          │                                      │
│                          ├── HuggingFace AI                    │
│                          │      │                              │
│                          │      ├── Analyze Vulnerabilities    │
│                          │      ├── Generate Recommendations   │
│                          │      └── Risk Assessment            │
│                          │                                      │
│                          └── Email Notification System         │
│                                 │                              │
│                                 ├── Send Scan Completion       │
│                                 ├── Send Security Alerts       │
│                                 └── Send Reports               │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Actor болон Use Case-ийн тодорхойлолт}

\begin{enumerate}
    \item \textbf{Normal User (Энгийн хэрэглэгч):}
    \begin{itemize}
        \item Үндсэн аюулгүй байдлын скан хийх
        \item Үр дүн харах, тайлан үүсгэх
        \item Хувийн профайл удирдах
    \end{itemize}
    
    \item \textbf{Premium User (Төлбөртэй хэрэглэгч):}
    \begin{itemize}
        \item Дэвшилтэт скан функцууд
        \item Баг удирдлага, хамтын ажиллагаа
        \item Тэргүүний дэмжлэг
    \end{itemize}
    
    \item \textbf{Admin User (Администратор):}
    \begin{itemize}
        \item Системийн удирдлага
        \item Хэрэглэгч удирдлага
        \item Тохиргоо, мониторинг
    \end{itemize}
    
    \item \textbf{External Systems (Гадаад системүүд):}
    \begin{itemize}
        \item OWASP ZAP - Аюулгүй байдлын сканнер
        \item HuggingFace AI - Зөвлөмж системийн AI
        \item Email System - Мэдэгдэл илгээх
    \end{itemize}
\end{enumerate}

\subsection{Системийн архитектур дизайн}

WebSecPen нь орчин үеийн вэб аппликейшний аюулгүй байдлыг автоматаар шалгах, мониторинг хийх зориулалттай систем юм. Систем нь client-server архитектураар хэрэгжиж, RESTful API ашиглан харилцдаг.

\subsubsection{Системийн ерөнхий архитектур}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Системийн архитектурын бүрэлдэхүүн]
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   React         │    │   Flask         │    │   PostgreSQL    │
│   Frontend      │◄──►│   Backend       │◄──►│   Database      │
│                 │    │                 │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                              │
                              ▼
                       ┌─────────────────┐
                       │   OWASP ZAP     │
                       │   Scanner       │
                       └─────────────────┘
                              │
                              ▼
                       ┌─────────────────┐
                       │   HuggingFace   │
                       │   AI Models     │
                       └─────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Дэлгэрэнгүй системийн архитектур диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=WebSecPen системийн бүрэн архитектур]
┌─────────────────────────────────────────────────────────────────┐
│                        Frontend Layer                           │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │   Login     │  │  Dashboard  │  │   Reports   │              │
│  │ Component   │  │ Component   │  │ Component   │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  ScanForm   │  │   Results   │  │    Admin    │              │
│  │ Component   │  │ Component   │  │ Component   │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
└─────────────────────────────────────────────────────────────────┘
                                │
                        HTTPS / REST API
                                │
┌─────────────────────────────────────────────────────────────────┐
│                        Backend Layer                            │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │    Auth     │  │    Scan     │  │   Report    │              │
│  │   Module    │  │   Module    │  │   Module    │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │   Admin     │  │  Analysis   │  │   Celery    │              │
│  │  Module     │  │   Module    │  │   Worker    │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
└─────────────────────────────────────────────────────────────────┘
                                │
                        Database Layer
                                │
┌─────────────────────────────────────────────────────────────────┐
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │ PostgreSQL  │  │    Redis    │  │   File      │              │
│  │  Database   │  │    Cache    │  │  Storage    │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
└─────────────────────────────────────────────────────────────────┘
                                │
                        External Services
                                │
┌─────────────────────────────────────────────────────────────────┐
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  OWASP ZAP  │  │ HuggingFace │  │   SMTP      │              │
│  │   Scanner   │  │  AI Models  │  │  Service    │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Архитектурын давуу тал}

\begin{enumerate}
    \item \textbf{Modular Architecture:}
    \begin{itemize}
        \item Бие даасан модулууд
        \item Засвар үйлчилгээ хийхэд хялбар
        \item Тусад нь тестлэх боломжтой
    \end{itemize}
    
    \item \textbf{Scalable Design:}
    \begin{itemize}
        \item Асинхрон ажлын дараалал
        \item Хэвтээ өргөжүүлэх боломж
        \item Load balancing дэмжлэг
    \end{itemize}
    
    \item \textbf{Security-First:}
    \begin{itemize}
        \item JWT authentication
        \item API rate limiting
        \item Input validation
        \item HTTPS encryption
    \end{itemize}
    
    \item \textbf{Performance Optimized:}
    \begin{itemize}
        \item Redis кэш систем
        \item Асинхрон процессинг
        \item Database indexing
        \item CDN дэмжлэг
    \end{itemize}
\end{enumerate}

\subsubsection{Өгөгдлийн урсгалын диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Скан процессийн өгөгдлийн урсгал]
User ──┐
       │
   1. Scan Request
       │
       ▼
React Frontend ──┐
                 │
             2. POST /api/scan/start
                 │
                 ▼
Flask Backend ──┐
                │
            3. Queue Task
                │
                ▼
Celery Worker ──┐
                │
            4. Execute ZAP Scan
                │
                ▼
OWASP ZAP ──┐
            │
        5. Return Results
            │
            ▼
AI Analysis ──┐
              │
          6. Generate Recommendations
              │
              ▼
Database ──┐
           │
       7. Store Results
           │
           ▼
Frontend ──┐
           │
       8. Display Results
           │
           ▼
User ── View Report
\end{lstlisting}
\end{figure}

\subsubsection{Deployment архитектур}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Production deployment архитектур]
┌─────────────────────────────────────────────────────────────────┐
│                        Production Environment                    │
│                                                                 │
│  ┌─────────────────┐                ┌─────────────────┐         │
│  │     Vercel      │                │     Render      │         │
│  │   Frontend      │ ──── HTTPS ──► │    Backend      │         │
│  │  (React SPA)    │                │  (Flask API)    │         │
│  └─────────────────┘                └─────────────────┘         │
│                                               │                 │
│                                        Database & Cache         │
│                                               │                 │
│  ┌─────────────────┐                ┌─────────────────┐         │
│  │   PostgreSQL    │ ◄──────────────┤     Redis       │         │
│  │   Database      │                │     Cache       │         │
│  │  (Render DB)    │                │  (Redis Cloud)  │         │
│  └─────────────────┘                └─────────────────┘         │
│                                                                 │
│  ┌─────────────────┐                ┌─────────────────┐         │
│  │    OWASP ZAP    │                │   HuggingFace   │         │
│  │    Scanner      │                │    AI Service   │         │
│  │  (Docker)       │                │     (API)       │         │
│  └─────────────────┘                └─────────────────┘         │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                      Development Environment                    │
│                                                                 │
│  ┌─────────────────┐                ┌─────────────────┐         │
│  │   localhost     │                │   localhost     │         │
│  │   React Dev     │ ──── HTTP ───► │   Flask Dev     │         │
│  │   :3000         │                │    :5000        │         │
│  └─────────────────┘                └─────────────────┘         │
│                                               │                 │
│  ┌─────────────────┐                ┌─────────────────┐         │
│  │   PostgreSQL    │ ◄──────────────┤     Redis       │         │
│  │   localhost     │                │   localhost     │         │
│  │   :5432         │                │    :6379        │         │
│  └─────────────────┘                └─────────────────┘         │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Network диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Системийн сүлжээний диаграм]
Internet
    │
    ▼
┌─────────────────┐
│   Load Balancer │ ◄── CDN (Content Delivery Network)
│   / Firewall    │
└─────────────────┘
    │
    ▼
┌─────────────────┐
│   Web Server    │ ◄── HTTPS/TLS
│   (Nginx)       │
└─────────────────┘
    │
    ├─── Static Files ──► File Storage (AWS S3 / Local)
    │
    ▼
┌─────────────────┐
│ Application     │
│ Server          │ ◄── Port 5000
│ (Flask + uWSGI) │
└─────────────────┘
    │
    ├─── Cache ──────► Redis (Port 6379)
    │
    ├─── Database ──► PostgreSQL (Port 5432)
    │
    ├─── Queue ─────► Celery Workers
    │                     │
    │                     ▼
    │               ┌─────────────────┐
    │               │   OWASP ZAP     │
    │               │   Scanner       │ ◄── Port 8080
    │               └─────────────────┘
    │
    └─── AI API ────► HuggingFace API
                         │
                         ▼
                   ┌─────────────────┐
                   │   AI Models     │
                   │   (GPT, BERT)   │
                   └─────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Аюулгүй байдлын архитектур}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Системийн аюулгүй байдлын архитектур]
┌─────────────────────────────────────────────────────────────────┐
│                     Security Layer                              │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Firewall      │    │   Rate Limiter  │    │   HTTPS     │  │
│  │   Protection    │────│   & DDoS        │────│   SSL/TLS   │  │
│  │                 │    │   Protection    │    │             │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                        ┌───────┴───────┐
                        │               │
┌─────────────────────────────────────────────────────────────────┐
│                  Authentication Layer                           │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   JWT Tokens    │    │   Password      │    │   MFA       │  │
│  │   Validation    │────│   Hashing       │────│   Support   │  │
│  │                 │    │   (bcrypt)      │    │   (TOTP)    │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                        ┌───────┴───────┐
                        │               │
┌─────────────────────────────────────────────────────────────────┐
│                  Authorization Layer                            │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Role Based    │    │   Permission    │    │   API Key   │  │
│  │   Access Control│────│   Management    │────│   Management│  │
│  │   (RBAC)        │    │                 │    │             │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                        ┌───────┴───────┐
                        │               │
┌─────────────────────────────────────────────────────────────────┐
│                    Data Protection                              │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Database      │    │   Input         │    │   Output    │  │
│  │   Encryption    │────│   Validation    │────│   Sanitization│ │
│  │   (AES-256)     │    │   & Filtering   │    │             │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Аюулгүй байдлын архитектур}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Системийн аюулгүй байдлын архитектур]
┌─────────────────────────────────────────────────────────────────┐
│                     Security Layer                              │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Firewall      │    │   Rate Limiter  │    │   HTTPS     │  │
│  │   Protection    │────│   & DDoS        │────│   SSL/TLS   │  │
│  │                 │    │   Protection    │    │             │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                        ┌───────┴───────┐
                        │               │
┌─────────────────────────────────────────────────────────────────┐
│                  Authentication Layer                           │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   JWT Tokens    │    │   Password      │    │   MFA       │  │
│  │   Validation    │────│   Hashing       │────│   Support   │  │
│  │                 │    │   (bcrypt)      │    │   (TOTP)    │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                        ┌───────┴───────┐
                        │               │
┌─────────────────────────────────────────────────────────────────┐
│                  Authorization Layer                            │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Role Based    │    │   Permission    │    │   API Key   │  │
│  │   Access Control│────│   Management    │────│   Management│  │
│  │   (RBAC)        │    │                 │    │             │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                        ┌───────┴───────┐
                        │               │
┌─────────────────────────────────────────────────────────────────┐
│                    Data Protection                              │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Database      │    │   Input         │    │   Output    │  │
│  │   Encryption    │────│   Validation    │────│   Sanitization│ │
│  │   (AES-256)     │    │   & Filtering   │    │             │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Үндсэн модулууд}
\begin{enumerate}
    \item \textbf{Authentication модуль:} JWT ашиглан хэрэглэгчийн баталгаажуулалт
    \item \textbf{Scan модуль:} OWASP ZAP интеграци, скан удирдлага
    \item \textbf{Analysis модуль:} Үр дүн шинжилгээ, AI зөвлөмж
    \item \textbf{Report модуль:} PDF тайлан үүсгэх
    \item \textbf{Admin модуль:} Системийн администраци
\end{enumerate}

\subsubsection{Модулын харилцан үйлчлэлийн диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Модулын харилцан үйлчлэл]
┌─────────────────────────────────────────────────────────────────┐
│                      Authentication Module                      │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Login/Logout  │    │   JWT Manager   │    │   User      │  │
│  │   Controller    │◄──►│                 │◄──►│   Session   │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Scan Module                              │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Scan          │    │   ZAP           │    │   Queue     │  │
│  │   Controller    │◄──►│   Integration   │◄──►│   Manager   │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                       Analysis Module                           │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   Vulnerability │    │   AI            │    │   Risk      │  │
│  │   Analyzer      │◄──►│   Advisor       │◄──►│   Assessor  │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Report Module                            │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   PDF           │    │   Template      │    │   Export    │  │
│  │   Generator     │◄──►│   Engine        │◄──►│   Manager   │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Admin Module                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │   User          │    │   System        │    │   Audit     │  │
│  │   Management    │◄──►│   Monitoring    │◄──►│   Logger    │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\subsection{Өгөгдлийн сангийн загвар}

Системийн өгөгдлийн сан нь дараах үндсэн entity-үүдээс бүрдэнэ:

\begin{lstlisting}[language=Python, caption=User модель]
class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password = db.Column(db.String(255), nullable=False)
    role = db.Column(db.String(20), default='free')
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    scans = db.relationship('Scan', backref='user', lazy=True)
\end{lstlisting}

\begin{lstlisting}[language=Python, caption=Scan модель]
class Scan(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'))
    url = db.Column(db.String(255), nullable=False)
    status = db.Column(db.String(50), default='pending')
    results = db.Column(db.JSON)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
\end{lstlisting}

\begin{lstlisting}[language=Python, caption=Vulnerability модель]
class Vulnerability(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    scan_id = db.Column(db.Integer, db.ForeignKey('scan.id'))
    type = db.Column(db.String(100), nullable=False)
    severity = db.Column(db.String(20), nullable=False)
    description = db.Column(db.Text)
    recommendation = db.Column(db.Text)
\end{lstlisting}

\subsubsection{Өгөгдлийн сангийн харилцааны диаграм (ER Diagram)}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Database Entity Relationship диаграм]
┌─────────────────────────────────────────────────────────────────┐
│                      Database Schema                            │
│                                                                 │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │      Users      │              │      Scans      │           │
│  ├─────────────────┤     1:N      ├─────────────────┤           │
│  │ id (PK)         │──────────────│ id (PK)         │           │
│  │ email           │              │ user_id (FK)    │           │
│  │ password_hash   │              │ url             │           │
│  │ role            │              │ status          │           │
│  │ mfa_secret      │              │ results (JSON)  │           │
│  │ mfa_enabled     │              │ created_at      │           │
│  │ created_at      │              │ updated_at      │           │
│  │ scan_limit      │              │ scan_type       │           │
│  │ preferences     │              │ task_id         │           │
│  └─────────────────┘              └─────────────────┘           │
│                                             │                   │
│                                             │ 1:N               │
│                                             ▼                   │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │   Vulnerabilities│              │    Reports      │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ id (PK)         │              │ id (PK)         │           │
│  │ scan_id (FK)    │              │ scan_id (FK)    │           │
│  │ type            │              │ format          │           │
│  │ severity        │              │ file_path       │           │
│  │ description     │              │ generated_at    │           │
│  │ recommendation  │              │ file_size       │           │
│  │ cvss_score      │              └─────────────────┘           │
│  │ status          │                                            │
│  │ found_at        │                                            │
│  └─────────────────┘                                            │
│                                                                 │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │    Sessions     │              │   Audit_Logs    │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ id (PK)         │              │ id (PK)         │           │
│  │ user_id (FK)    │              │ user_id (FK)    │           │
│  │ token           │              │ action          │           │
│  │ expires_at      │              │ details (JSON)  │           │
│  │ created_at      │              │ ip_address      │           │
│  │ ip_address      │              │ user_agent      │           │
│  │ user_agent      │              │ timestamp       │           │
│  └─────────────────┘              └─────────────────┘           │
│                                                                 │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │    Settings     │              │    Schedules    │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ id (PK)         │              │ id (PK)         │           │
│  │ user_id (FK)    │              │ user_id (FK)    │           │
│  │ key             │              │ url             │           │
│  │ value           │              │ frequency       │           │
│  │ updated_at      │              │ last_run        │           │
│  └─────────────────┘              │ next_run        │           │
│                                   │ enabled         │           │
│                                   └─────────────────┘           │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\subsubsection{Өгөгдлийн сангийн оновчтой байдал}

\begin{enumerate}
    \item \textbf{Normalization:}
    \begin{itemize}
        \item 3NF (Third Normal Form) стандартад нийцүүлэх
        \item Давхардлыг арилгах
        \item Data integrity хангах
    \end{itemize}
    
    \item \textbf{Indexing стратеги:}
    \begin{itemize}
        \item Primary keys (автомат index)
        \item Foreign keys дээр index
        \item Байнга хайх талбарууд (email, url)
        \item Composite index (user\_id + created\_at)
    \end{itemize}
    
    \item \textbf{Performance optimization:}
    \begin{itemize}
        \item Connection pooling
        \item Query optimization
        \item Read replica ашиглах
        \item Caching layer (Redis)
    \end{itemize}
\end{enumerate}

\subsection{REST API дизайн}

Системийн API нь RESTful архитектурын дагуу дизайлагдсан бөгөөд дараах үндсэн endpoint-ууд байна:

\subsubsection{Authentication endpoints}
\begin{lstlisting}[language=bash, caption=Аутентификацийн API]
POST /api/auth/register  - Бүртгүүлэх
POST /api/auth/login     - Нэвтрэх
POST /api/auth/logout    - Гарах
GET  /api/auth/profile   - Профайл харах
\end{lstlisting}

\subsubsection{Scan endpoints}
\begin{lstlisting}[language=bash, caption=Сканны API]
POST /api/scan/start     - Шинэ скан эхлүүлэх
GET  /api/scan/history   - Скан түүх харах
GET  /api/scan/result/{id} - Скан үр дүн авах
DELETE /api/scan/{id}    - Скан устгах
\end{lstlisting}

\subsubsection{Report endpoints}
\begin{lstlisting}[language=bash, caption=Тайлангийн API]
GET  /api/report/{scan_id}/pdf    - PDF тайлан татах
GET  /api/report/{scan_id}/json   - JSON форматаар авах
POST /api/report/generate         - Тайлан үүсгэх
\end{lstlisting}

\subsection{Frontend компонент дизайн}

React ашиглан бүтээсэн frontend нь дараах үндсэн компонентуудаас бүрдэнэ:

\begin{lstlisting}[language=JavaScript, caption=App.js - Үндсэн компонент]
function App() {
  return (
    <Router>
      <div className="App">
        <Header />
        <Routes>
          <Route path="/login" element={<Login />} />
          <Route path="/dashboard" element={<Dashboard />} />
          <Route path="/scan" element={<ScanForm />} />
          <Route path="/results" element={<Results />} />
        </Routes>
      </div>
    </Router>
  );
}
\end{lstlisting}

\subsubsection{Dashboard компонент}
\begin{itemize}
    \item Нийт скан тоо
    \item Сүүлийн үр дүн
    \item Аюулын түвшин график
    \item Хурдан скан эхлүүлэх товч
\end{itemize}

\subsubsection{ScanForm компонент}
\begin{itemize}
    \item URL оруулах талбар
    \item Скан төрөл сонгох
    \item Дэвшилтэт тохиргоо
    \item Скан эхлүүлэх товч
\end{itemize}

\section{Вэб аппликейшний аюулгүй байдлын шинжилгээ}

\subsection{OWASP ZAP интеграци}

OWASP ZAP (Zed Attack Proxy) нь нээлттэй эхийн вэб аппликейшний аюулгүй байдлын шалгалтын хамгийн алдартай багаж юм. WebSecPen систем нь ZAP-ийн Python API ашиглан интеграци хийсэн.

\begin{lstlisting}[language=Python, caption=ZAP Scanner класс]
from zapv2 import ZAPv2

class ZAPScanner:
    def __init__(self):
        self.zap = ZAPv2(proxies={'http': 'http://127.0.0.1:8080'})
    
    def start_spider_scan(self, url):
        scan_id = self.zap.spider.scan(url)
        return scan_id
    
    def start_active_scan(self, url):
        scan_id = self.zap.ascan.scan(url)
        return scan_id
    
    def get_alerts(self):
        return self.zap.core.alerts()
\end{lstlisting}

\subsubsection{Скан төрлүүд}
\begin{enumerate}
    \item \textbf{Spider скан:}
    \begin{itemize}
        \item Вэб сайтын бүтцийг судлах
        \item Линк, хуудас олж илрүүлэх
        \item Sitemap үүсгэх
    \end{itemize}
    
    \item \textbf{Active скан:}
    \begin{itemize}
        \item Бодит халдлага симуляци
        \item SQL injection, XSS тест
        \item Аюулгүй байдлын сул тал илрүүлэх
    \end{itemize}
    
    \item \textbf{Passive скан:}
    \begin{itemize}
        \item HTTP дүрэм зөрчил илрүүлэх
        \item Мэдээлэл алдагдах эрсдэл
        \item Тохиргооны алдаа
    \end{itemize}
\end{enumerate}

\subsection{Аюулгүй байдлын шинжилгээний алгоритм}

Системд хэрэгжүүлсэн шинжилгээний алгоритм нь OWASP Top 10 стандартад тулгуурладаг \cite{3}:

\subsubsection{Аюулын ангилал}
\begin{enumerate}
    \item \textbf{Critical (Маш эмзэг):}
    \begin{itemize}
        \item SQL Injection
        \item Remote Code Execution
        \item Authentication Bypass
    \end{itemize}
    
    \item \textbf{High (Өндөр):}
    \begin{itemize}
        \item Cross-Site Scripting (XSS)
        \item Cross-Site Request Forgery (CSRF)
        \item Insecure Direct Object Reference
    \end{itemize}
    
    \item \textbf{Medium (Дунд):}
    \begin{itemize}
        \item Session Management алдаа
        \item Input Validation алдаа
        \item Information Disclosure
    \end{itemize}
    
    \item \textbf{Low (Бага):}
    \begin{itemize}
        \item HTTP Header дутагдал
        \item Cookie тохиргооны алдаа
        \item Version дэлгэх
    \end{itemize}
\end{enumerate}

\subsection{AI ашиглан зөвлөмж систем}

HuggingFace-ийн NLP моделийг ашиглан илрүүлсэн аюулгүй байдлын асуудалд зөвлөмж, засварлах арга зам санал болгох систем хөгжүүлэв \cite{12}.

\begin{lstlisting}[language=Python, caption=AI Vulnerability Advisor]
from transformers import pipeline

class VulnerabilityAdvisor:
    def __init__(self):
        self.generator = pipeline('text-generation', 
                                model='gpt2')
    
    def get_recommendation(self, vulnerability_type, description):
        prompt = f"""
        Vulnerability: {vulnerability_type}
        Description: {description}
        
        Recommended solution:
        """
        
        response = self.generator(prompt, 
                                max_length=200, 
                                num_return_sequences=1)
        return response[0]['generated_text']
\end{lstlisting}

\subsubsection{Зөвлөмжийн ангилал}
\begin{enumerate}
    \item \textbf{Засмад санал:}
    \begin{itemize}
        \item Кодын жишээ
        \item Тохиргооны өөрчлөлт
        \item Шинэ хамгаалалтын арга
    \end{itemize}
    
    \item \textbf{Урьдчилан сэргийлэх арга:}
    \begin{itemize}
        \item Input validation
        \item Output encoding
        \item Access control
    \end{itemize}
    
    \item \textbf{Мониторинг санал:}
    \begin{itemize}
        \item Log хөтлөх
        \item Анхааруулга тохируулах
        \item Тогтмол шалгалт
    \end{itemize}
\end{enumerate}

\section{Автомат шалгалтын системийн бүтээн байгуулалт}

\subsection{Celery ашиглан асинхрон ажлын дараалал}

Скан процесс нь удаан ажилладаг тул асинхрон байдлаар ажиллуулах шаардлагатай. Үүний тулд Celery ашиглан background task систем хэрэгжүүлэв \cite{13}.

\begin{lstlisting}[language=Python, caption=Celery асинхрон даалгавар]
from celery import Celery

celery_app = Celery('websecpen',
                   broker='redis://localhost:6379/0',
                   backend='redis://localhost:6379/0')

@celery_app.task
def start_security_scan(url, user_id):
    # ZAP скан эхлүүлэх
    scanner = ZAPScanner()
    
    # Spider скан
    spider_id = scanner.start_spider_scan(url)
    
    # Spider дуусах хүртэл хүлээх
    while int(scanner.zap.spider.status(spider_id)) < 100:
        time.sleep(5)
    
    # Active скан
    active_id = scanner.start_active_scan(url)
    
    # Active скан дуусах хүртэл хүлээх
    while int(scanner.zap.ascan.status(active_id)) < 100:
        time.sleep(10)
    
    # Үр дүн авах
    alerts = scanner.get_alerts()
    
    # Өгөгдлийн санд хадгалах
    scan = Scan(user_id=user_id, url=url, 
                status='completed', results=alerts)
    db.session.add(scan)
    db.session.commit()
    
    return scan.id
\end{lstlisting}

\subsection{Redis кэш система}

Скан үр дүн, хэрэглэгчийн session зэрэг өгөгдлийг хурдан харуулахын тулд Redis кэш систем ашигласан \cite{14}.

\begin{lstlisting}[language=Python, caption=Redis кэш системийн ашиглалт]
import redis

redis_client = redis.Redis(host='localhost', port=6379, db=0)

def cache_scan_result(scan_id, result):
    key = f"scan_result:{scan_id}"
    redis_client.setex(key, 3600, json.dumps(result))  # 1 цагийн кэш

def get_cached_result(scan_id):
    key = f"scan_result:{scan_id}"
    cached = redis_client.get(key)
    if cached:
        return json.loads(cached)
    return None
\end{lstlisting}

\section{Системийн дизайн диаграмууд}

\subsection{Use Case диаграм}

\subsubsection{WebSecPen Use Case диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=WebSecPen Use Case диаграм]
┌─────────────────────────────────────────────────────────────────┐
│                         WebSecPen System                        │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   Authentication                        │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │    │
│  │  │   Register  │  │    Login    │  │   Logout    │     │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘     │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                Security Scanning                        │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │    │
│  │  │ Start Scan  │  │ View Scan   │  │ Download    │     │    │
│  │  │             │  │   Results   │  │   Report    │     │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘     │    │
│  │                                                         │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │    │
│  │  │   Schedule  │  │   Cancel    │  │    Delete   │     │    │
│  │  │    Scan     │  │    Scan     │  │     Scan    │     │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘     │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                     Analysis                            │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │    │
│  │  │    View     │  │   Get AI    │  │   Export    │     │    │
│  │  │Vulnerabilities│ │Recommendations│ │  Results   │     │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘     │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                  Administration                         │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │    │
│  │  │   Manage    │  │   View      │  │   System    │     │    │
│  │  │   Users     │  │   Reports   │  │ Monitoring  │     │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘     │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘

Actors:
┌─────────────┐        ┌─────────────┐        ┌─────────────┐
│   Regular   │        │   Premium   │        │    Admin    │
│    User     │        │    User     │        │    User     │
└─────────────┘        └─────────────┘        └─────────────┘
      │                       │                       │
      ▼                       ▼                       ▼
Authentication          Authentication          Authentication
Security Scanning       Security Scanning       Security Scanning
Analysis                Analysis                Analysis
                       Schedule Scans          Administration
                       Premium Features        System Monitoring
\end{lstlisting}
\end{figure}

\subsubsection{Actor-ууд ба тэдгээрийн эрх}

\begin{enumerate}
    \item \textbf{Regular User (Энгийн хэрэглэгч):}
    \begin{itemize}
        \item Бүртгүүлэх, нэвтрэх, гарах
        \item Скан эхлүүлэх (хязгаартай)
        \item Үр дүн харах
        \item AI зөвлөмж авах
        \item Тайлан татах
    \end{itemize}
    
    \item \textbf{Premium User (Төлбөртэй хэрэглэгч):}
    \begin{itemize}
        \item Энгийн хэрэглэгчийн бүх эрх
        \item Хязгааргүй скан
        \item Автомат скан товлох
        \item Дэвшилтэт тайлан
        \item API хандалт
    \end{itemize}
    
    \item \textbf{Admin User (Админ хэрэглэгч):}
    \begin{itemize}
        \item Бүх хэрэглэгчийн эрх
        \item Хэрэглэгч удирдлага
        \item Системийн мониторинг
        \item Тохиргоо өөрчлөх
        \item Аудит лог харах
    \end{itemize}
\end{enumerate}

\subsection{Activity диаграм}

\subsubsection{Скан процессийн Activity диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Security Scan Activity диаграм]
Start
  │
  ▼
┌─────────────────┐
│ User Login      │
│ Validation      │
└─────────────────┘
  │
  ▼
┌─────────────────┐
│ Enter Target    │
│ URL             │
└─────────────────┘
  │
  ▼
┌─────────────────┐      No    ┌─────────────────┐
│ URL Validation  │──────────► │ Show Error      │
│                 │            │ Message         │
└─────────────────┘            └─────────────────┘
  │ Yes                               │
  ▼                                   │
┌─────────────────┐                   │
│ Check Scan      │      Exceeded     │
│ Limits          │──────────────────►│
└─────────────────┘                   │
  │ Within Limit                      │
  ▼                                   │
┌─────────────────┐                   │
│ Queue Scan      │                   │
│ Task            │                   │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ Start ZAP       │                   │
│ Scanner         │                   │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ Spider Scan     │                   │
│ (Discovery)     │                   │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ Active Scan     │                   │
│ (Vulnerability) │                   │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ Collect         │                   │
│ Results         │                   │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ AI Analysis     │                   │
│ & Recommendations│                  │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ Store Results   │                   │
│ in Database     │                   │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ Notify User     │                   │
│ (Email/Push)    │                   │
└─────────────────┘                   │
  │                                   │
  ▼                                   │
┌─────────────────┐                   │
│ Generate        │◄──────────────────┘
│ Report          │
└─────────────────┘
  │
  ▼
End
\end{lstlisting}
\end{figure}

\subsection{Sequence диаграм}

\subsubsection{Скан эхлүүлэх Sequence диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Start Scan Sequence диаграм]
User    Frontend    Backend    Celery    ZAP    Database    AI
 │         │          │         │        │        │        │
 │ Start   │          │         │        │        │        │
 │ Scan    │          │         │        │        │        │
 ├────────►│          │         │        │        │        │
 │         │ POST     │         │        │        │        │
 │         │/api/scan │         │        │        │        │
 │         │/start    │         │        │        │        │
 │         ├─────────►│         │        │        │        │
 │         │          │ Validate│        │        │        │
 │         │          │ Request │        │        │        │
 │         │          ├─────────┤       │        │        │
 │         │          │         │        │        │        │
 │         │          │ Queue   │        │        │        │
 │         │          │ Task    │        │        │        │
 │         │          ├────────►│        │        │        │
 │         │          │         │ Start  │        │        │
 │         │          │         │ Spider │        │        │
 │         │          │         ├───────►│        │        │
 │         │          │         │        │ Spider │        │
 │         │          │         │        │ Scan   │        │
 │         │          │         │        ├────────┤       │
 │         │          │         │        │        │        │
 │         │          │         │ Start  │        │        │
 │         │          │         │ Active │        │        │
 │         │          │         │ Scan   │        │        │
 │         │          │         ├───────►│        │        │
 │         │          │         │        │ Active │        │
 │         │          │         │        │ Scan   │        │
 │         │          │         │        ├────────┤       │
 │         │          │         │        │        │        │
 │         │          │         │ Get    │        │        │
 │         │          │         │ Results│        │        │
 │         │          │         ├───────►│        │        │
 │         │          │         │◄───────┤        │        │
 │         │          │         │        │        │        │
 │         │          │         │ AI     │        │        │
 │         │          │         │ Analysis        │        │
 │         │          │         ├───────────────────────►│
 │         │          │         │◄───────────────────────┤
 │         │          │         │        │        │        │
 │         │          │         │ Store  │        │        │
 │         │          │         │ Results│        │        │
 │         │          │         ├───────────────►│        │
 │         │          │         │        │        │        │
 │         │          │ Task    │        │        │        │
 │         │          │ Complete│        │        │        │
 │         │          │◄────────┤        │        │        │
 │         │ 200 OK   │         │        │        │        │
 │         │ Scan ID  │         │        │        │        │
 │         │◄─────────┤         │        │        │        │
 │ Success │          │         │        │        │        │
 │◄────────┤          │         │        │        │        │
\end{lstlisting}
\end{figure}

\subsection{State диаграм}

\subsubsection{Скан төлвийн State диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=Scan State диаграм]
                    ┌─────────────────┐
                    │     Initial     │
                    │     State       │
                    └─────────────────┘
                              │
                       Start Scan
                              │
                              ▼
                    ┌─────────────────┐
              ┌────►│     Queued      │
              │     │                 │
              │     └─────────────────┘
              │               │
              │        Worker Available
              │               │
              │               ▼
              │     ┌─────────────────┐      Error
              │     │    Running      │─────────────┐
              │     │                 │             │
              │     └─────────────────┘             │
              │               │                     │
         Queue Full           │                     │
              │        Spider Complete              │
              │               │                     │
              │               ▼                     │
              │     ┌─────────────────┐             │
              │     │ Spider Running  │             │
              │     │                 │             │
              │     └─────────────────┘             │
              │               │                     │
              │        Active Scan Start            │
              │               │                     │
              │               ▼                     │
              │     ┌─────────────────┐             │
              │     │ Active Scanning │             │
              │     │                 │             │
              │     └─────────────────┘             │
              │               │                     │
              │        Scan Complete                │
              │               │                     │
              │               ▼                     │
              │     ┌─────────────────┐             │
              │     │   Processing    │             │
              │     │   Results       │             │
              │     └─────────────────┘             │
              │               │                     │
              │        AI Analysis Done             │
              │               │                     │
              │               ▼                     │
              │     ┌─────────────────┐             │
              │     │   Completed     │             │
              │     │                 │             │
              │     └─────────────────┘             │
              │               │                     │
              │        Retry/New Scan               │
              │               │                     │
              │               ▼                     │
              └─────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │     Failed      │
                    │                 │
                    └─────────────────┘
                              │
                       Manual Retry
                              │
                              ▼
                    ┌─────────────────┐
                    │     Retry       │
                    │                 │
                    └─────────────────┘
\end{lstlisting}
\end{figure}

\subsection{Class диаграм}

\subsubsection{Үндсэн класс диаграм}

\begin{figure}[h]
\centering
\begin{lstlisting}[language=bash, caption=WebSecPen Class диаграм]
┌─────────────────────────────────────────────────────────────────┐
│                        WebSecPen Classes                        │
│                                                                 │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │      User       │              │      Scan       │           │
│  ├─────────────────┤     1:N      ├─────────────────┤           │
│  │ - id: int       │──────────────│ - id: int       │           │
│  │ - email: str    │              │ - user_id: int  │           │
│  │ - password: str │              │ - url: str      │           │
│  │ - role: str     │              │ - status: str   │           │
│  │ - created_at    │              │ - results: JSON │           │
│  ├─────────────────┤              │ - created_at    │           │
│  │ + login()       │              ├─────────────────┤           │
│  │ + logout()      │              │ + start()       │           │
│  │ + register()    │              │ + stop()        │           │
│  │ + validate()    │              │ + get_results() │           │
│  └─────────────────┘              └─────────────────┘           │
│                                             │                   │
│                                             │ 1:N               │
│                                             ▼                   │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │ Vulnerability   │              │     Report      │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ - id: int       │              │ - id: int       │           │
│  │ - scan_id: int  │              │ - scan_id: int  │           │
│  │ - type: str     │              │ - format: str   │           │
│  │ - severity: str │              │ - file_path: str│           │
│  │ - description   │              │ - generated_at  │           │
│  │ - recommendation│              ├─────────────────┤           │
│  ├─────────────────┤              │ + generate()    │           │
│  │ + analyze()     │              │ + export()      │           │
│  │ + get_cvss()    │              │ + download()    │           │
│  │ + remediate()   │              └─────────────────┘           │
│  └─────────────────┘                                            │
│                                                                 │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │   ZAPScanner    │              │  AIAdvisor      │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ - zap_client    │              │ - model: str    │           │
│  │ - proxy_url     │              │ - api_key: str  │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ + spider_scan() │              │ + analyze()     │           │
│  │ + active_scan() │              │ + recommend()   │           │
│  │ + get_alerts()  │              │ + prioritize()  │           │
│  │ + start_proxy() │              └─────────────────┘           │
│  └─────────────────┘                                            │
│                                                                 │
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │   ScanManager   │              │  ReportManager  │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ - queue: Queue  │              │ - templates     │           │
│  │ - workers: List │              │ - formats: List │           │
│  ├─────────────────┤              ├─────────────────┤           │
│  │ + queue_scan()  │              │ + create_pdf()  │           │
│  │ + process()     │              │ + create_json() │           │
│  │ + monitor()     │              │ + create_csv()  │           │
│  └─────────────────┘              └─────────────────┘           │
└─────────────────────────────────────────────────────────────────┘
\end{lstlisting}
\end{figure}

\end{document} 